steps:
  F_Salesorder-77:
    operation:
      config:
        insertStrategy: UNION
        selectDistinct: false
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: BI
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 13197
              stepCounter: "77"
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: DELIVERY_STATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 12332
                    stepCounter: "73"
                transform: ""
          - columnReference:
              columnCounter: 13204
              stepCounter: "77"
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: OVERALL_STATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 12339
                    stepCounter: "73"
                transform: ""
          - columnReference:
              columnCounter: 13285
              stepCounter: "77"
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Item_Delivery_Status
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 12467
                    stepCounter: "75"
                transform: ""
          - columnReference:
              columnCounter: 13326
              stepCounter: "77"
            dataType: char(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: sales_document_number
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000004997
                    stepCounter: "200000074"
                transform: trim("Sales_Document_Header"."Sales_Document_Id" , '0')
          - columnReference:
              columnCounter: 13327
              stepCounter: "77"
            dataType: char(8)
            description: ""
            hashColumns: []
            hashDetails: null
            name: CREATED_DATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000004998
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13329
              stepCounter: "77"
            dataType: char(12)
            description: ""
            hashColumns: []
            hashDetails: null
            name: CREATED_BY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005000
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13332
              stepCounter: "77"
            dataType: char(8)
            description: ""
            hashColumns: []
            hashDetails: null
            name: DOCUMENT_DATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005003
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13333
              stepCounter: "77"
            dataType: char(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SD_DOCUMENT_CATEGORY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005004
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13335
              stepCounter: "77"
            dataType: char(4)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SALES_DOCUMENT_TYPE_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005006
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13336
              stepCounter: "77"
            dataType: char(3)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_REASON_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005007
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13339
              stepCounter: "77"
            dataType: char(2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: delivery_block_id
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005010
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13343
              stepCounter: "77"
            dataType: char(4)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SALES_ORGANIZATION_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005014
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13344
              stepCounter: "77"
            dataType: char(2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: DISTRIBUTION_CHANNEL_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005015
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13345
              stepCounter: "77"
            dataType: char(2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: DIVISION_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005016
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13353
              stepCounter: "77"
            dataType: char(8)
            description: ""
            hashColumns: []
            hashDetails: null
            name: REQUESTED_DELIVERY_DATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005024
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13372
              stepCounter: "77"
            dataType: char(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SALES_DOCUMENT_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005043
                    stepCounter: "200000074"
                transform: ""
          - columnReference:
              columnCounter: 13487
              stepCounter: "77"
            dataType: char(6)
            description: ""
            hashColumns: []
            hashDetails: null
            name: sales_document_item
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005158
                    stepCounter: "200000075"
                transform: ltrim("Sales_Document_Item"."Sales_Document_Item_Id"  , '0')
          - columnReference:
              columnCounter: 13488
              stepCounter: "77"
            dataType: char(18)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MATERIAL_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005159
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13492
              stepCounter: "77"
            dataType: char(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MATERIAL_GROUP_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005163
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13494
              stepCounter: "77"
            dataType: char(4)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SALES_DOCUMENT_ITEM_CATEGORY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005165
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13500
              stepCounter: "77"
            dataType: char(2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: REASON_REJECTION_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005171
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13501
              stepCounter: "77"
            dataType: char(18)
            description: ""
            hashColumns: []
            hashDetails: null
            name: PRODUCT_HIERARCHY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005172
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13507
              stepCounter: "77"
            dataType: char(3)
            description: ""
            hashColumns: []
            hashDetails: null
            name: BASE_UOM_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005178
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13528
              stepCounter: "77"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: net_value
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005199
                    stepCounter: "200000075"
                transform: case when "Sales_Document_Header"."Sd_Document_Category"  = 'C' then "Sales_Document_Item"."Net_Val" else "Sales_Document_Item"."Net_Val"  * -1 end
          - columnReference:
              columnCounter: 13529
              stepCounter: "77"
            dataType: char(5)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SD_DOCUMENT_CURRENCY_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005200
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13533
              stepCounter: "77"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Order_Quantity
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005204
                    stepCounter: "200000075"
                transform: case when "Sales_Document_Header"."Sd_Document_Category"  = 'C' then "Sales_Document_Item"."Order_Quantity" else "Sales_Document_Item"."Order_Quantity"  * -1 end
          - columnReference:
              columnCounter: 13537
              stepCounter: "77"
            dataType: char(3)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SALES_UOM_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005208
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13540
              stepCounter: "77"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: gross_weight
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005211
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13542
              stepCounter: "77"
            dataType: char(3)
            description: ""
            hashColumns: []
            hashDetails: null
            name: WEIGHT_UOM_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005213
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13553
              stepCounter: "77"
            dataType: char(4)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Plant_Id
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005224
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13577
              stepCounter: "77"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: net_price
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005248
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13580
              stepCounter: "77"
            dataType: char(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: RETURNS_ITEM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005251
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13871
              stepCounter: "77"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: HVR_IS_DELETED
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005542
                    stepCounter: "200000075"
                transform: ""
          - columnReference:
              columnCounter: 13872
              stepCounter: "77"
            dataType: TIMESTAMP_TZ(3)
            description: ""
            hashColumns: []
            hashDetails: null
            name: HVR_CHANGE_TIME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2000005543
                    stepCounter: "200000075"
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              Sales_Document_Header: "200000074"
              Sales_Document_Header_Status: "73"
              Sales_Document_Item: "200000075"
              Sales_Document_Item_Status: "75"
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: STG
                nodeName: Sales_Document_Header_Status
              - locationName: STG
                nodeName: Sales_Document_Item_Status
              - locationName: STG
                nodeName: Sales_Document_Header
              - locationName: STG
                nodeName: Sales_Document_Item
            join:
              joinCondition: |-
                FROM {{ ref('STG', 'Sales_Document_Header') }} "Sales_Document_Header"
                INNER JOIN {{ ref('STG', 'Sales_Document_Item') }} "Sales_Document_Item"
                ON "Sales_Document_Header"."Sales_Document_Id" = "Sales_Document_Item"."Sales_Document_Id"
                INNER JOIN {{ ref('STG', 'Sales_Document_Header_Status') }} "Sales_Document_Header_Status"
                ON "Sales_Document_Header"."Sales_Document_Id" = "Sales_Document_Header_Status"."Sales_Document_Id"
                INNER JOIN {{ ref('STG', 'Sales_Document_Item_Status') }} "Sales_Document_Item_Status"
                ON "Sales_Document_Item"."Sales_Document_Id" = "Sales_Document_Item_Status"."Sales_Document_Id"
                AND "Sales_Document_Item"."Sales_Document_Item_Id" = "Sales_Document_Item_Status"."Sd_Item_Id"
                AND "Sales_Document_Header"."Sd_Document_Category" in ('C', 'H')
            name: F_Salesorder
            noLinkRefs: []
      name: F_Salesorder
      overrideSQL: false
      schema: ""
      sqlType: "1"
      type: sql
    stepCounter: "77"
